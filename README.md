# sasa_screenshot_chrome

## ささっとスクショで囲もう

Webページのスクリーンショットをサッと撮って、四角・丸・矢印で囲んだり、太さや色を変えて注釈して、そのままダウンロードやクリップボードにコピーできるChrome拡張。

### 特長
- **表示中の画面をキャプチャ**: 今見えている範囲をワンクリックで撮影
- **ドラッグで範囲選択キャプチャ**: 必要なところだけ切り取り撮影
- **注釈ツール**: 四角形・円・矢印・選択・消しゴム、色と線の太さを調整可能
- **出力**: PNGでダウンロード or クリップボードに直接コピー
- **オフライン動作**: 画像や注釈はローカル処理。サーバー送信なし

---

### インストール（開発用）
1. Chromeで `chrome://extensions` を開く
2. 右上の「デベロッパーモード」をオン
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. このフォルダ（`ささっとスクショで囲もう`）を選択
5. 拡張機能をピン留めしておくと使いやすい

Edgeの場合は `edge://extensions` で同様の手順。

---

### 使い方
- **表示部分をキャプチャ**: 拡張アイコン → ポップアップの「表示部分をキャプチャ」
  - 新しいタブでエディターが開き、画像上に注釈が描ける
- **範囲を選択してキャプチャ**: ポップアップの「範囲を選択してキャプチャ」
  - 画面が十字カーソルになる → ドラッグで範囲指定 → 自動で切り出し → エディターが開く

エディター（`editor.html`）の主な操作:
- **ツール**: 選択 / 四角形 / 円形 / 矢印 / 消しゴム
- **色**: パレットから選択（黒、赤、青、緑、黄）
- **線の太さ**: スライダーで1〜20px
- **コピー**: 画像をクリップボードへ（PNG）
- **ダウンロード**: `screenshot-YYYYMMDD-HHMMSS.png` で保存

---

### 権限について（`manifest.json`）
- **activeTab**: アクティブなタブのキャプチャ許可
- **scripting / tabs**: コンテンツスクリプトの注入やタブ操作に使用
- **clipboardWrite**: エディターからPNGをクリップボードへコピー
- **host_permissions: <all_urls>**: ほとんどのサイトで動作させるため
- **desktopCapture**: 将来的な拡張のために入っています（現状未使用）

拡張はデータを外部送信しません。スクリーンショットは一時的にバックグラウンドで保持し、エディターへ渡したら破棄します。

---

### ファイル構成
```
ささっとスクショで囲もう/
├─ manifest.json        # MV3 マニフェスト
├─ background.js        # キャプチャ実行・一時保存・エディター起動
├─ content.js           # 範囲選択UIと切り出し処理
├─ popup.html / .js     # ランチャー（2つのキャプチャモード）
├─ editor.html / .js    # 注釈エディター（描画、コピー、保存）
└─ styles.css           # ポップアップ/エディターのスタイル
```

---

### ざっくり仕組み
- ポップアップから実行 → バックグラウンドが `captureVisibleTab` でPNGを取得
- 範囲選択モードの場合は、`content.js` でドラッグ矩形を作り、可視範囲キャプチャから該当部分だけCanvasで切り出し
- 画像データはバックグラウンドに一時保存 → 新規タブで `editor.html` を開く → `getImageData` で受け取り描画
- エディター上ではCanvasに注釈（四角/円/矢印等）を重ねて、コピー/保存
- Google Docs / スプレッドシートの変換（transformなど）で崩れないよう、撮影前後に一時的なスタイル調整を実施

---

### 既知の制限・注意
- **全ページ（縦長の全体）スクロール撮影には未対応**。今は「見えている範囲」＋「任意範囲切り出し」のみ
- **chrome:// や 拡張機能のページ**はブラウザの制約でキャプチャ不可
- サイトのアクセス権限は「すべてのサイト」にしておくと安定（範囲選択の注入に必要）
- High DPI（Retina等）でも綺麗に切り出すため、`devicePixelRatio` を考慮

---

### トラブルシュート
- 「範囲選択を開始できませんでした」→ 拡張のサイトアクセス権限を「すべてのサイト」に設定し、ページをリロード
- 画像が荒い/ズレる → ブラウザの拡大縮小を確認（標準100%推奨）。それでも改善しない場合は環境情報と一緒に報告してください

---

### 開発メモ
- 変更後は `chrome://extensions` → 対象拡張の「更新」ボタンでリロード
- `console` ログは背景（Service Worker）、ポップアップ、コンテンツ、エディターそれぞれのDevToolsで確認
- アイコンやi18nは未同梱。必要なら `manifest.json` を拡張してください
- アイコンフォントに [Font Awesome 6（CDN）](https://cdnjs.com/libraries/font-awesome) を利用

---

### ライセンス / クレジット
- ライセンス: 未設定（必要に応じて追加してください）
- Copyright © プロジェクトオーナー

